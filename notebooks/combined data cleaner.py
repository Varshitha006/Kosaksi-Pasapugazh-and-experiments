# -*- coding: utf-8 -*-
"""Combined_Data_cleaning.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1RqEDUhbWZK7PmYSBNUPeJge4kibvyK9E
"""

!git clone "https://github.com/dcs-sastra/Kosaksi-Pasapugazh-and-experiments"

import pandas as pd
import numpy as np
from sklearn.experimental import enable_iterative_imputer
from sklearn.impute import IterativeImputer

df = pd.read_csv('/content/Kosaksi-Pasapugazh-and-experiments/data/raw/Environment - ICRISAT/Combined_Data.csv')
df = df.drop(columns = ['State Name','Dist Name'])
df.head()

df1 = pd.DataFrame(df[df.columns[5:]])
df1.info()

"""***Rows with full of zeros are removed***"""

all_zeros = (df1 == 0).all(axis=1)
indices_with_all_zeros = df1.index[all_zeros].tolist()
count_all_zeros = all_zeros.sum()
print(f"indices with all zeros :{indices_with_all_zeros}")
print(f"Number of rows with all zeros: {count_all_zeros}")

df1 = df1[~all_zeros]
df1.info()

df = df.drop(indices_with_all_zeros)
df.info()

"""***Imputation is done where ever the -1 is found***"""

df.replace(-1, np.nan, inplace=True)
imputer = IterativeImputer(max_iter=10,random_state=42)
df = pd.DataFrame(imputer.fit_transform(df), columns=df.columns)
df.info()

df.to_csv('Cleaned_Combined_Data.csv', index=False)
